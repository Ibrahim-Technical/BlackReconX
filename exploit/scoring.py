
def score_target(port_proto_map):
    score = 0
    notes = []

    for port, proto in port_proto_map.items():
        proto = proto.lower()

        if proto in ["ftp"]:
            score += 10
            notes.append(f"FTP on port {port}: possible anonymous or weak login")
        elif proto in ["ssh"]:
            score += 20
            notes.append(f"SSH on port {port}: direct access potential")
        elif proto in ["http", "https"]:
            score += 25
            notes.append(f"HTTP(S) on port {port}: CMS, login panels, SQLi, XSS...")
        elif proto in ["mysql", "ms-sql-s", "mssql"]:
            score += 20
            notes.append(f"Database {proto.upper()} on port {port}: sensitive data access")
        elif proto == "udp":
            score += 5
            notes.append(f"UDP service on port {port}: further analysis required")
        else:
            score += 5
            notes.append(f"Unknown service on port {port}: manual inspection needed")

    # Normalize score to max 100
    final_score = min(score, 100)
    return final_score, notes
